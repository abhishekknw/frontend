<!-- <nav-bar></nav-bar> -->
<link rel="stylesheet" href="modules/pages/login/login.tmpl.css" />
<link rel="stylesheet" href="modules/common/loadingicon/loading-spinner.tmpl.css" />

<script src="https://www.google.com/recaptcha/api.js" async defer></script>
<link href="css/smallscreen.css" rel="stylesheet" media="screen" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
  /*aisensy*/


  div.white-space-pre-line {
    white-space: pre-line;
  }

  .navbar-collapse.in {
    overflow-y: hidden;
    /* overflow-x: hidden; */
    margin-bottom: 10px;
    /* display: block; */
  }

  /* .navbar-right{
	padding:  0px 10px;
	position:relative;
	display:inline-block;
	top:15px;
	background-color: white;
	border-color: white;
}
.navbar-right li{
	margin-right: 30px;
	color: rgba(20, 1, 1, 0.904);
}
.navbar-right li:hover{
	color: rgb(201, 67, 67);
}
@media screen and (max-width: 560px) {
	.navbar-right li{
		float: left;
	
		position: relative;
		height:100%;
        width:100%;
        z-index :-1;
		padding: 10px;
        display: block;
	}

	.navbar-right li:hover{
		color: rgb(201, 67, 67);
	}

} */

  /*tabs-aisensy*/

  .tab-aisensy {
    margin-top: 20px;
    padding: 0px;
  }

  /* #content1 input {
	display:none;
  }*/
  .tab-aisensy input[type="radio"] {
    display: none;
  }

  .tab-aisensy label {

    display: inline-block;
    padding: 3px;
    /* margin: 0 -1px; */
    width: 32.5%;
    border: 1px solid #000;
    text-align: center;
    margin-bottom: 10px;
    border-radius: 15px;
  }

  /* @media screen and (max-width: 450px) {
	.tab-aisensy label {
		display: inline-block;
		padding: 6px 0 6px 0;
		margin: 0 -1px;
		width: 33.33%; 
		border: 1px solid #000;
		text-align: center;
		margin-bottom: 10px;
	  }
	
} */
  .tab-aisensy label:hover {
    cursor: pointer;
    /*background-color: #8a130f;*/
  }

  #active-nab {
    color: #8a130f;
  }

  .tab-aisensy input:checked+label {
    border: 1px solid #000;
    border-width: 1px 1px 1px 1px;
    background-color: #8a130f;
    border-radius: 15px;
  }

  .tab-aisensy #tab-1:checked~.content #content-1,
  .tab-aisensy #tab-2:checked~.content #content-2,
  .tab-aisensy #tab-3:checked~.content #content-3 {
    display: block;
  }

  .tab-aisensy .content>div {
    display: none;
    text-align: center;
    /*height: 192px;*/
    overflow: auto;
  }

  /*active chat list*/
  .profile-image {
    width: 50px;
    height: 50px;
    border-radius: 40px;
    background-color: white;
    font-weight: normal;
    font-size: xx-large;
    text-align: center;
  }


  .search-box {
    background: #e3e3e3;
    padding: 10px 13px;
  }

  .search-box .input-wrapper {
    background: white;
    border-radius: 40px;
  }

  .search-box i {
    color: blue;

    vertical-align: middle;
  }


  input {
    border: none;
    border-radius: 30px;
    width: 80%;
    height: 30px;
  }

  input ::placeholder {
    color: #e3e3e3;
    font-weight: 300;
    margin-left: 20px;
  }

  input:focus {
    outline: none;
  }

  .friend-drawer {
    padding: 10px 15px;
    display: flex;
    vertical-align: baseline;
    background: #fff;
    transition: .3s ease;
    background: #eee;
  }

  /*&--grey {
	  background: #eee;
	}*/

  .friend-drawer.text {
    /* margin-left: 12px; */
    width: 70%;
  }

  .friend-drawer h6 {
    /* margin-top: 6px; */
    margin-bottom: 0;
    margin-left: 15px;
    font-weight: 800;
    font-size: 15px;
    text-align: left;

  }

  .text-muted p {
    margin-left: 20px;
  }

  .friend-drawer p {
    margin: 0;
    margin-left: 15px;
    font-weight: 800;
    font-size: 15px;
    text-align: left;
  }


  .time {
    color: black;
    text-align: right;
    font-weight: 300;
    float: right;
  }

  .friend-drawer--onhover:hover {
    /*background: grey;*/

    cursor: pointer;
  }

  .friend-drawer--onhover p,
  h6,
  time {
    color: black !important;
    font-weight: 300;
  }

  hr {
    margin: 5px auto;
    width: 100%;
  }

  .fields-box {
    margin: 0;
    padding: 0;
    height: auto;
    overflow-y: scroll;
    overflow-x: hidden;
  }

  .profile-image-chat {
    text-align: center;
    font-size: 25px;
    background-color: aliceblue;
    border-radius: 50px;
    margin-left: 87%;
    width: 30px;
    margin-top: -38px;
  }

  /*status*/
  .status-image {
    width: 50px;
    height: 50px;
    border-radius: 40px;

  }

  @media screen {
    .status-image {
      width: 50px;
      height: 50px;
      border-radius: 40px;
      /* align-items: center; */
      background-color: lightgrey;
      /* transform: translate(280%,-20%); */
      font-size: xx-large;
      text-align: center;
    }

    .friend-drawer-status h6 {
      margin-bottom: 0;
      font-weight: 800;
      font-size: 15px;
      margin-top: -10px;
    }

    .friend-drawer-status p {
      margin-bottom: 0;
      font-weight: 800;
      font-size: 15px;

    }
  }


  .friend-drawer-status.text {
    margin-left: 12px;
    width: 70%;
  }

  .friend-drawer-status h6 {
    margin-top: 6px;
    margin-bottom: 0;
    margin-left: 13px;
    font-weight: 800;
    font-size: 15px;
  }

  .friend-drawer-status p {
    font-weight: 800;
    margin-left: 13px;
    font-size: 15px;
  }



  /*Alignment*/
  .row-aisensy {
    margin-right: -18px;
    margin-left: -18px;
  }

  .aisensy-page {
    margin-top: 30px;
  }

  #sector-aisensy {
    width: 40%;
    margin: 0 auto;
    margin-top: 10px;
    width: 100%;
  }

  /*dropdown box*/
  .bs-example input[type="radio"] {
    display: none;
  }

  .bs-example label {
    display: inline-block;
    padding: 6px 0 6px 0;
    margin: 0 -2px;
    width: 100%;
    border: 1px solid #000;
    text-align: center;
  }

  .bs-example label:hover {
    cursor: pointer;
    background-color: #8a130f;
  }

  /*timeline*/
  ul.timeline {
    list-style-type: none;
    position: relative;
  }

  ul.timeline:before {
    content: ' ';
    background: #d4d9df;
    display: inline-block;
    position: absolute;
    left: 29px;
    width: 2px;
    height: 100%;
    z-index: 400;
  }

  ul.timeline>li {
    margin: 20px 0;
    padding-left: 50px;
  }

  ul.timeline>li:before {
    content: ' ';
    background: white;
    display: inline-block;
    position: absolute;
    border-radius: 50%;
    border: 3px solid #22c0e8;
    left: 20px;
    width: 20px;
    height: 20px;
    z-index: 400;

  }

  /*chat window*/
  @import url(https://fonts.googleapis.com/css?family=Roboto:400,600);

  .phone-chat {

    border-radius: 10px;
    width: auto;
    height: auto;
    margin: auto;

    padding: 16px 5px;
  }

  .screen-phone {
    background-color: #fff;
    width: 100%;
    height: 100%;
    border-radius: 10px;
    overflow: hidden;

  }

  .nav-phone {
    width: 100%;
    height: 50px;
    background-color: #00966c;
    box-shadow: 0 1px 11px #0000004d;
    padding: 4px;
    position: relative;
    z-index: 0;
  }

  .username {
    font: 18px Roboto;
    font-weight: 600;
    color: #fff;
  }

  .tel-number {
    font-family: Roboto;
    color: #fff;
  }

  .chat {
    width: 100%;
    height: 400px;
    overflow: auto;
    padding: 10px;
    /* transform: rotate(180deg); */
  }

  .message-1 {
    border-radius: 7px;
    background-color: #e0e0e0;
    padding: 5px;
    font: 15px "Roboto", Segoe UI, sans-serif;
    /* width: calc(100% + -50px); */
    max-width: calc(100% + -50px);
    min-width: 150px;
    margin-bottom: 10px;
    float: right;
    text-align: left;


    /* transform: rotate(-180deg); */
  }

  .message-2 {

    border-radius: 7px;
    background-color: #aede2e;
    padding: 5px;
    font: 15px "Roboto", Segoe UI, sans-serif;
    /* width: calc(100% + -50px); */
    max-width: calc(100% + -50px);
    min-width: 250px;
    margin-bottom: 10px;
    float: left;
    text-align: left;
    /* transform: rotate(-180deg); */
  }

  .icon-back {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #0000;
    padding: 7px;
    position: relative;
    overflow: hidden;
    transition: background-color 200ms ease-in-out;
    float: left;
    margin-right: 7px;
  }

  .icon-back:hover {
    background-color: #ffffff47;
  }

  .icon-back:active {
    background-color: #ffffff94;
  }

  .icon-cross {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: #ababab;
    padding: 7px;
    position: relative;
    overflow: hidden;
    transition: background-color 200ms ease-in-out;
    float: right;
    margin-right: 7px;
    top: -90px;
  }

  .icon-cross:hover {
    background-color: rgb(145, 43, 43);
  }

  .icon-cross:active {
    background-color: #08080894;
  }

  /* .message:nth-child(odd) {
  float: left;
  background-color: #e0e0e0;
}
.message:nth-child(even) {
  float: right;
  background-color: #aede2e;
} */
  .message-1 span {
    color: #000000cc;
    font-size: 11.5px;
    font-weight: 600;
    float: right;
    margin-top: 5px;
  }

  .message-2 span {
    color: #000000cc;
    font-size: 11.5px;
    font-weight: 600;
    float: right;
    margin-top: 5px;
  }

  .chat::-webkit-scrollbar {
    width: 10px;
    height: 10px;

  }

  .chat::-webkit-scrollbar-thumb {
    background-color: #00000070;
    border: 2px solid #fff;
    border-radius: 10px;
  }

  .input {
    border-radius: 50px;
    box-shadow: 0 1px 11px #0000004d;
    padding: 8px;
    width: calc(100% + -72px);
    margin: 5px 0 0 8px;
    float: left;
  }

  .input * {
    font-family: Roboto;
    outline: none;
    border: none;
    caret-color: #00966c;
  }

  .input *::placeholder {
    color: #929292;
  }

  .btn-send {
    width: 40px;
    height: 40px;
    background-color: #00966c;
    border-radius: 50%;
    float: right;
    margin: 3px 11px 0 0;
    padding: 8px;
    transition: background-color 150ms ease-in-out;
  }

  .btn-send:hover {
    background-color: #00ad7c;
  }

  .btn-send:active {
    background-color: #48d4ad;
  }

  * {
    box-sizing: border-box;
  }

  .add-button {
    float: right;

  }

      [scroll-glue]{
        height: 20.1pc;
        overflow-y: scroll;
        border: 1px solid gray;
      }
    
</style>


<div ng-init="getActiveUser()  ">

  <!-- navbar -->
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <a class="navbar-brand">
        <div class="logo-sec-mca">
          <img src="images/machadalo-logo.png" alt="" title="" />
        </div>
      </a>

      <div class="nav-aisensy">
        <input type="checkbox" id="nav-aisensy-check">
        <div class="nav-aisensy-btn">
          <label for="nav-aisensy-check">
            <span></span>
            <span></span>
            <span></span>
          </label>
        </div>

        <div class="nav-aisensy-links">
          <a target="_blank" class="fa fa-comments" id="active-nav" aria-hidden="true" style="font-size: large"
            ng-click="getActiveUser()">
            Live chat</a>
          <a target="_blank" class="fa fa-user-circle" aria-hidden="true" style="font-size: large"
            ng-click="contactDetail()">
            Contact</a>
          <a target="_blank" class="fa fa-history" aria-hidden="true" style="font-size: large"
            ng-click="historyDetail()">
            History</a>
          <a target="_blank" class="fa fa-file-text" aria-hidden="true" style="font-size: large"
            ng-click=templateDetail()>
            Template</a>
          <a target="_blank" class="fa fa-filter" aria-hidden="true" style="font-size: large" ng-click=filterDetail()>
            Filter</a>
          <!-- </div> -->
        </div>
      </div>
      <!--/.nav-collapse -->
    </div>
  </nav>
  <!-- /navbar -->

  <!--Active chat list + status + chat details-->

  <div ng-if="!showhistoryDetail && !showcontactDetail && showgetActiveUser">
    <div class="container dropdown mca-page">
      <!--tabs-->
      <div class="top-select-option-aisensy">
        <div class="form-group">
          <div class="tab-aisensy">
            <input id="tab-1" type="radio" name="tab" ng-model="tab.name" value="tabA">
            <label for="tab-1">Active</label>
            <input id="tab-2" type="radio" name="tab" ng-model="tab.name" value="tabB">
            <label for="tab-2" ng-click="getActionRequiredUser()">Action Required</label>
            <input id="tab-3" type="radio" name="tab" ng-model="tab.name" value="tabC">
            <label for="tab-3" ng-click="getInterveneUser()">Intervened</label>

            <div class="content">
              <div id="content-1">
                <div class="row-aisensy no-gutters">
                  <div class="col-md-12 col-xs-12 border-right">
                    <div class="search-box" ng-if="!showChatModule">
                      <div class="input-wrapper">
                        <i class="fa fa-search" aria-hidden="true"></i>
                        <input placeholder="Search here" ng-change="searchChat(search)" ng-model="search" id="search"
                          name="search" type="text" />
                      </div>
                    </div>

                    <div class="fields-box">
                      <div ng-if="!showChatModule">
                        <table class="table table-bordered table-hover">

                          <tbody>
                            <tr dir-paginate="user in activeUserData | itemsPerPage:itemsPerPage"
                              total-items="totalCount" current-page="pagination.current" track by "$index">
                              <td>
                                <div class="friend-drawer friend-drawer--onhover"
                                  ng-click="userDetail(user.phone_number)">

                                  <div class="profile-image">
                                    {{user.whatsapp_name |firstlater}}
                                  </div>
                                  <div class="text">
                                    <h6>{{user.whatsapp_name}}</h6>
                                    <p class="text-muted"><b>
                                        {{user.country_code}}{{user.phone_number}}
                                      </b></p>
                                    <p>
                                      {{user.last_message | limitTo: 50 }} {{user.last_message.length > 50 ? '...' :
                                      ''}}
                                    </p>
                                  </div>
                                  <div style="text-align: right;">
                                    <span class="time text-muted small">
                                      <b>{{user.updated_at | date :'medium'}}</b>
                                    </span>
                                  </div>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                        <dir-pagination-controls max-size="10" on-page-change="liveChatPageChanged(newPageNumber)"
                          boundary-links="true">
                        </dir-pagination-controls>
                      </div>

                      <!-- <div ng-if="!showChatModule" ng-repeat="user in activeUserData track by $index">
                          <div class="friend-drawer friend-drawer--onhover" ng-click="userDetail(user.phone_number)">
                            <div class="profile-image">
                              {{user.whatsapp_name |firstlater}}
                            </div>
                            <div class="text">
                              <h6>{{user.whatsapp_name}}</h6>
                              <p class="text-muted">
                                {{user.country_code}}{{user.phone_number}}
                              </p>
                            </div>
                            <span class="time text-muted small">{{user.updated_at | date :
                              'medium'}}</span>
                          </div>

                          <hr />
                        </div> -->

                      <!-- Start Phone Chat for tab1-->
                      <div class="phone-chat" ng-if="showChatModule && !isUserProfile">
                        <div class="screen-phone">
                          <div class="nav-phone navbar-fixed">

                            <div class="icon-back">
                              <svg viewBox="0 0 57.653 64.11" width="25" height="25" xmlns="http://www.w3.org/2000/svg"
                                ng-click="hideChatModule()">

                                <path fill="#fff"
                                  d="M 31.75 0 L 0 31.956 L 30.961 63.124 L 36.412 57.26 L 15.768 36.41 L 56.313 35.997 L 56.107 28.366 L 15.484 28.572 L 37.35 6.086 L 31.75 0 Z" />
                              </svg>


                            </div>
                            <div ng-click="userProfileIcon()">

                              <span class="username">{{userChatData.whatsapp_name}}</span><br />
                              <span class="tel-number">({{userChatData.country_code}}{{userChatData.phone_number}})
                              </span>

                              <div class="profile-image-chat">
                                <span ng-if="userChatData.whatsapp_name!=''">
                                  {{userChatData.whatsapp_name |firstlater}}
                                </span>
                                <span ng-if="userChatData.whatsapp_name==''">#</span>
                              </div>
                            </div>

                          </div>

                          <div class="chat">
                            <div ng-repeat="chat in userChatData.payload track by $index">
                              <!-- <div > {{chat.timestamp | date : format : timezone}}</div> -->
                              <div style="width: 100%; float:right;">
                                <div class="message-1" ng-if="chat.sender=='user'">
                                  {{chat.content.text}}
                                  <span>{{chat.timestamp | date :'h:mma'}}</span>
                                </div>
                              </div>

                              <div class="message-2 white-space-pre-line" ng-if="chat.sender=='bot'">
                                {{chat.content.text}}
                                <span>{{chat.timestamp | date : 'h:mma'}}</span>
                              </div>
                            </div>

                          </div>
                          <div ng-if="messageBox">
                            <div class="input">
                              <input type="text" placeholder="Write message" />
                            </div>
                            <div class="btn-send">
                              <svg viewBox="0 0 74.433 60.908" width="25" height="25"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill="#fff"
                                  d="M 0 0 L 74.22 26.562 L 0.246 60.712 L 7.608 34.535 L 27.831 28.259 L 6.91 25.469 L 0 0 Z" />
                              </svg>
                            </div>

                            <div class="aisensy-resolve-btn">
                              <button type="button" class="btn btn-success" style="margin-top:20px"
                                ng-click="interveneButton()">
                                Resolve
                              </button>
                            </div>
                          </div>


                          <div class="aisensy-intervene-btn" ng-click="writeMessage()" ng-if="!messageBox"
                            style="margin-top:5px">
                            <button type="button" class="btn btn-primary">
                              Intervene
                            </button>
                          </div>
                        </div>
                      </div>
                      <!--End Phone Chat  for tab1-->
                    </div>
                  </div>
                </div>
              </div>
              <!--end of first tab content-->

              <div id="content-2">
                <div class="row-aisensy no-gutters">
                  <div class="col-md-12 col-xs-12 border-right">
                    <div class="search-box" ng-if="!showChatModule">
                      <div class="input-wrapper">
                        <i class="fa fa-search" aria-hidden="true"></i>
                        <input placeholder="Search here" ng-change="getActionRequiredUser(actionsearch)"
                          ng-model="actionsearch" id="search" name="search" type="text" />
                      </div>
                    </div>
                    <div class="fields-box">
                      <div ng-if="!showChatModule">
                        <table class="table table-bordered table-hover">

                          <tbody>
                            <tr dir-paginate="user in actionRequiredUserData | itemsPerPage:itemsPerPage"
                              total-items="totalCount" current-page="pagination.current" track by "$index">
                              <td>
                                <div class="friend-drawer friend-drawer--onhover"
                                  ng-click="userDetail(user.phone_number)">

                                  <div class="profile-image">
                                    {{user.whatsapp_name |firstlater}}
                                  </div>
                                  <div class="text">
                                    <h6>{{user.whatsapp_name}}</h6>
                                    <p class="text-muted"><b>
                                        {{user.country_code}}{{user.phone_number}}
                                      </b></p>
                                    <p>
                                      {{user.last_message | limitTo: 50 }} {{user.last_message.length > 50 ? '...' :
                                      ''}}
                                    </p>
                                  </div>

                                  <span class="time text-muted small"><b>{{user.updated_at | date :
                                      'medium'}}</b></span>

                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                        <dir-pagination-controls max-size="10" on-page-change="liveChatPageChanged(newPageNumber)"
                          boundary-links="true">
                        </dir-pagination-controls>
                      </div>
                      <!-- Start Phone Chat  for tab2-->
                      <div class="phone-chat" ng-if="showChatModule && !isUserProfile">
                        <div class="screen-phone">
                          <div class="nav-phone navbar-fixed">

                            <div class="icon-back">
                              <svg viewBox="0 0 57.653 64.11" width="25" height="25" xmlns="http://www.w3.org/2000/svg"
                                ng-click="hideChatModule()">

                                <path fill="#fff"
                                  d="M 31.75 0 L 0 31.956 L 30.961 63.124 L 36.412 57.26 L 15.768 36.41 L 56.313 35.997 L 56.107 28.366 L 15.484 28.572 L 37.35 6.086 L 31.75 0 Z" />
                              </svg>


                            </div>
                            <div ng-click="userProfileIcon()">

                              <span class="username">{{userChatData.whatsapp_name}}</span><br />
                              <span
                                class="tel-number">({{userChatData.country_code}}{{userChatData.phone_number}})</span>

                              <div class="profile-image-chat">
                                {{userChatData.whatsapp_name |firstlater}}
                              </div>
                            </div>

                          </div>

                          <div class="chat">
                            <div ng-repeat="chat in userChatData.payload track by $index">
                              <!-- <div > {{chat.timestamp | date : format : timezone}}</div> -->
                              <div style="width: 100%; float:right;">
                                <div class="message-1" ng-if="chat.sender=='user'">
                                  {{chat.content.text}}
                                  <span>{{chat.timestamp | date :'h:mma'}}</span>
                                </div>
                              </div>

                              <div class="message-2 white-space-pre-line" ng-if="chat.sender=='bot'">
                                {{chat.content.text}}
                                <span>{{chat.timestamp | date : 'h:mma'}}</span>
                              </div>
                            </div>

                          </div>
                          <div ng-if="messageBox">
                            <div class="input">
                              <input type="text" placeholder="Write message" />
                            </div>
                            <div class="btn-send">
                              <svg viewBox="0 0 74.433 60.908" width="25" height="25"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill="#fff"
                                  d="M 0 0 L 74.22 26.562 L 0.246 60.712 L 7.608 34.535 L 27.831 28.259 L 6.91 25.469 L 0 0 Z" />
                              </svg>
                            </div>

                            <div class="aisensy-resolve-btn">
                              <button type="button" class="btn btn-success" style="margin-top:20px"
                                ng-click="interveneButton()">
                                Resolve
                              </button>
                            </div>
                          </div>


                          <div class="aisensy-intervene-btn" ng-click="writeMessage()" ng-if="!messageBox"
                            style="margin-top:5px">
                            <button type="button" class="btn btn-primary">
                              Intervene
                            </button>
                          </div>
                        </div>
                      </div>
                      <!--End Phone Chat  for tab2-->
                    </div>
                  </div>
                </div>
              </div>
              <!--end of second tab content-->

              <div id="content-3">
                <div class="row-aisensy no-gutters">
                  <div class="col-md-12 col-xs-12 border-right">
                    <div class="search-box" ng-if="!showChatModule">
                      <div class="input-wrapper">
                        <i class="fa fa-search" aria-hidden="true"></i>
                        <input placeholder="Search here" ng-change="searchIntervene()" ng-model="intervenesearch"
                          id="searchIn" name="search" type="text" />
                      </div>
                    </div>
                    <div class="fields-box">
                      <div ng-if="!showChatModule">
                        <table class="table table-bordered table-hover">

                          <tbody>
                            <tr dir-paginate="user in interveneUserData | itemsPerPage:itemsPerPage"
                              total-items="totalCount" current-page="pagination.current" track by "$index">
                              <td>
                                <div class="friend-drawer friend-drawer--onhover"
                                  ng-click="userDetail(user.phone_number)">

                                  <div class="profile-image">
                                    {{user.whatsapp_name |firstlater}}
                                  </div>
                                  <div class="text">
                                    <h6>{{user.whatsapp_name}}</h6>
                                    <p class="text-muted"><b>
                                        {{user.country_code}}{{user.phone_number}}
                                      </b></p>
                                    <p>
                                      {{user.last_message | limitTo: 50 }} {{user.last_message.length > 50 ? '...' :
                                      ''}}
                                    </p>
                                  </div>

                                  <span class="time text-muted small"><b>{{user.updated_at | date :
                                      'medium'}}</b></span>

                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                        <dir-pagination-controls max-size="10" on-page-change="liveChatPageChanged(newPageNumber)"
                          boundary-links="true">
                        </dir-pagination-controls>
                      </div>

                      <!-- Start Phone Chat  for tab3-->
                      <div class="phone-chat" ng-if="showChatModule && !isUserProfile">
                        <div class="screen-phone">
                          <div class="nav-phone navbar-fixed">

                            <div class="icon-back">
                              <svg viewBox="0 0 57.653 64.11" width="25" height="25" xmlns="http://www.w3.org/2000/svg"
                                ng-click="hideChatModule()">

                                <path fill="#fff"
                                  d="M 31.75 0 L 0 31.956 L 30.961 63.124 L 36.412 57.26 L 15.768 36.41 L 56.313 35.997 L 56.107 28.366 L 15.484 28.572 L 37.35 6.086 L 31.75 0 Z" />
                              </svg>
                            </div>
                            <div ng-click="userProfileIcon()">

                              <span class="username">{{userChatData.whatsapp_name}}</span><br />
                              <span
                                class="tel-number">({{userChatData.country_code}}{{userChatData.phone_number}})</span>

                              <div class="profile-image-chat">
                                {{userChatData.whatsapp_name |firstlater}}
                              </div>
                            </div>

                          </div>

                          <div class="chat">
                            <div ng-repeat="chat in userChatData.payload track by $index">
                              <!-- <div > {{chat.timestamp | date : format : timezone}}</div> -->
                              <div style="width: 100%; float:right;">
                                <div class="message-1" ng-if="chat.sender=='user'">
                                  {{chat.content.text}}
                                  <span>{{chat.timestamp | date :'h:mma'}}</span>
                                </div>
                              </div>

                              <div class="message-2 white-space-pre-line" ng-if="chat.sender=='bot'">
                                {{chat.content.text}}
                                <span>{{chat.timestamp | date : 'h:mma'}}</span>
                              </div>
                            </div>

                          </div>
                          <div ng-if="messageBox">
                            <div class="input">
                              <input type="text" placeholder="Write message" />
                            </div>
                            <div class="btn-send">
                              <svg viewBox="0 0 74.433 60.908" width="25" height="25"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill="#fff"
                                  d="M 0 0 L 74.22 26.562 L 0.246 60.712 L 7.608 34.535 L 27.831 28.259 L 6.91 25.469 L 0 0 Z" />
                              </svg>
                            </div>

                            <div class="aisensy-resolve-btn">
                              <button type="button" class="btn btn-success" style="margin-top:20px"
                                ng-click="interveneButton()">
                                Resolve
                              </button>
                            </div>
                          </div>


                          <div class="aisensy-intervene-btn" ng-click="writeMessage()" ng-if="!messageBox"
                            style="margin-top:5px">
                            <button type="button" class="btn btn-primary">
                              Intervene
                            </button>
                          </div>
                        </div>
                      </div>
                      <!--End Phone Chat  for tab3-->
                    </div>
                  </div>
                </div>
              </div>
              <!--end of third tab content-->
            </div>
          </div>
        </div>
      </div>
      <!--/tabs-->
    </div>
    <!-- Status -->
    <div class="container dropdown aisensy-page">
      <div ng-if="userDetailData && isUserProfile">
        <div class="top-select-option-mca">
          <div class="form-group">
            <div class="profile">
              <div class="friend-drawer-status friend-drawer--onhover">
                <!-- <img
                class="status-image center"
                src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/robocop.jpg"
                alt=""
              /><br /> -->


                <div class="status-image">
                  {{userDetailData.whatsapp_name |firstlater}}
                </div>
                <div class="text">
                  <h6>{{userDetailData.whatsapp_name}}</h6>
                  <p class="text-muted">
                    {{userDetailData.country_code}}{{userDetailData.phone_number}}
                  </p>
                  <div class="icon-cross" ng-click="userChatIcon()">
                    <svg class="svg-icon" viewBox="0 0 20 20">
                      <path fill="#fff"
                        d="M15.898,4.045c-0.271-0.272-0.713-0.272-0.986,0l-4.71,4.711L5.493,4.045c-0.272-0.272-0.714-0.272-0.986,0s-0.272,0.714,0,0.986l4.709,4.711l-4.71,4.711c-0.272,0.271-0.272,0.713,0,0.986c0.136,0.136,0.314,0.203,0.492,0.203c0.179,0,0.357-0.067,0.493-0.203l4.711-4.711l4.71,4.711c0.137,0.136,0.314,0.203,0.494,0.203c0.178,0,0.355-0.067,0.492-0.203c0.273-0.273,0.273-0.715,0-0.986l-4.711-4.711l4.711-4.711C16.172,4.759,16.172,4.317,15.898,4.045z">
                      </path>
                    </svg>
                  </div>
                </div>
                <hr />

                <div class="filter-card">
                  <div class="row">
                    <div class="col-sm-12">
                      <div class="info-table-wrap-mca">
                        <div class="info-table-covidhelp">
                          <div class="info-row-mca">
                            <label class="infolable-mca"> Session ID:</label>
                            <span> {{userDetailData.session_id}}</span>
                          </div>

                          <div class="info-row-mca">
                            <label class="infolable-mca">User Type:</label>
                            <span> {{userDetailData.user_type}}</span>
                          </div>

                          <div class="info-row-mca">
                            <label class="infolable-mca">Created At:</label>
                            <span>
                              {{userDetailData.created_at | date :
                              'medium'}}</span>
                          </div>

                          <div class="info-row-mca">
                            <label class="infolable-mca">Last Active:</label>
                            <span>
                              {{userDetailData.updated_at | date :
                              'medium'}}</span>
                          </div>

                          <!-- 
                    <div class="info-row-mca">
                      <label class="infolable-mca">Template Messages:</label>
                      <span> {{cases.yesterday_confirmed}}</span>
                    </div> -->

                          <!-- <div class="info-row-mca">
                      <label class="infolable-mca">Session Messages:</label>
                      <span> {{cases.yesterday_confirmed}}</span>
                    </div> -->

                          <!-- <div class="info-row-mca">
                      <label class="infolable-mca">Unsolved Queries:</label>
                      <span> {{cases.yesterday_confirmed}}</span>
                    </div> -->

                          <!-- <div class="info-row-mca">
                      <label class="infolable-mca">Source:</label>
                      <span> {{cases.yesterday_confirmed}}</span>
                    </div>

                    <div class="info-row-mca">
                      <label class="infolable-mca">Lead State:</label>
                      <span> {{cases.yesterday_confirmed}}</span>
                    </div>

                    <div class="info-row-mca">
                      <label class="infolable-mca">First Message:</label>
                      <span> {{cases.yesterday_confirmed}}</span>
                    </div> -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Status End -->

                <!-- <select class="form-control" name="sector" id="sector-aisensy" ng-change="changeWeb()" ng-model="selectedsector">
          <option value="" disabled>Template Messages</option>
          <option ng-repeat="sec in sectorArray track by $index" value="{{sec.name}}"
            style="text-transform: capitalize">
            {{cat.name}}
          </option>
        </select>
        <select class="form-control" name="sector" id="sector-aisensy" ng-change="changeWeb()" ng-model="selectedsector">
          <option value="" disabled>Customer Journey</option>
          <option ng-repeat="sec in sectorArray track by $index" value="{{sec.name}}"
            style="text-transform: capitalize">
            {{cat.name}}
          </option>
        </select>-->
              </div>
            </div>
          </div>
        </div>
        <!--end status-->

        <!-- Start Template and Customer Journey-->
        <div class="bs-example col-md-12 col-xs-12">
          <label class="radio-inline">
            <input name="group1" value="1" data-toggle="collapse" data-parent="#accordion" data-target="#collapseOne"
              type="radio" />
            Template message
          </label>

          <div class="panel-group" id="accordion">
            <div class="panel panel-default">
              <div id="collapseOne" class="panel-collapse collapse in">
                <div class="panel-body">
                  <h4>These are some Template message given to this user</h4>
                </div>
              </div>
            </div>

            <label class="radio-inline">
              <input name="group1" value="2" data-toggle="collapse" data-parent="#accordion" data-target="#collapseTwo"
                type="radio" />
              Customer Journey
            </label>

            <div class="panel panel-default">
              <div id="collapseTwo" class="panel-collapse collapse">
                <div class="panel-body">
                  <div class="container mt-5 mb-5">
                    <div class="row">
                      <div class="col-md-6 offset-md-3">
                        <ul class="timeline">
                          <li>
                            <h5>User requested intervention</h5>
                            <h6>18:45, 19 Aug 2021</h6>
                          </li>
                          <li>
                            <h5>Chat closed by XYZ</h5>
                            <h6>15:15, 17 Aug 2021</h6>
                          </li>
                          <li>
                            <h5>Chat intervened by XYZ</h5>
                            <h6>14:43, 17 Aug 2021</h6>
                          </li>
                          <li>
                            <h5>User requested intervention</h5>
                            <h6>09:03, 15 Aug 2021</h6>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- End Template and Customer Journey-->
      </div>

      <!-- Start Phone Chat-->
      <!-- <div class="phone-chat" ng-if="showChatModule">
      <div class="screen-phone">
        <div class="nav-phone">
          <div class="icon-back">
            <svg
              viewBox="0 0 57.653 64.11"
              width="25"
              height="25"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill="#fff"
                d="M 31.75 0 L 0 31.956 L 30.961 63.124 L 36.412 57.26 L 15.768 36.41 L 56.313 35.997 L 56.107 28.366 L 15.484 28.572 L 37.35 6.086 L 31.75 0 Z"
              />
            </svg>
          </div>
          <span class="username">{{userChatData.whatsapp_name}}</span><br />
          <span class="tel-number"
            >{{userChatData.country_code}}{{userChatData.phone_number}}</span
          >
        </div>
        <div class="chat">
          <div ng-repeat="chat in userChatData.payload track by $index">
            <div class="message-1" ng-if="chat.sender=='user'">
              {{chat.content.text}}
              <span>{{chat.timestamp | date : format : timezone}}</span>
            </div>

            <div class="message-2" ng-if="chat.sender=='bot'">
              {{chat.content.text}}
              <span>{{chat.timestamp | date : format : timezone}}</span>
            </div>
          </div>
          <div class="input">
            <input type="text" placeholder="Write message" />
          </div>
          <div class="btn-send">
            <svg
              viewBox="0 0 74.433 60.908"
              width="25"
              height="25"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fill="#fff"
                d="M 0 0 L 74.22 26.562 L 0.246 60.712 L 7.608 34.535 L 27.831 28.259 L 6.91 25.469 L 0 0 Z"
              />
            </svg>
          </div>
        </div>
      </div>
    </div> -->
    </div>
    <!--/ Status-->
  </div>

  <!--/Active chat list + status + chat details-->

  <!--History Tab-->
  <div class="container dropdown mca-page" ng-if="showhistoryDetail">
    <div class="top-select-option-aisensy">
      <div class="form-group">
        <div class="col-md-12 col-xs-12 border-right">
          <h3><b>
              <center>CHAT HISTORY</center>
            </b>
          </h3>
          <div ng-if="!showChatModule">
            <div class="search-box">
              <div class="input-wrapper">
                <i class="fa fa-search" aria-hidden="true" style="margin-left: 10px"></i>
                <input placeholder="Search here" ng-change="searchChatHistory(historySearch)" ng-model="historySearch"
                  type="text" />
              </div>
            </div>
            <table class="table table-bordered table-hover">

              <tbody>
                <tr dir-paginate="details in historyDetailData | itemsPerPage:itemsPerPage" total-items="totalCount"
                  current-page="pagination.current" track by "$index">
                  <td>
                    <div class="friend-drawer friend-drawer--onhover" ng-click="userDetail(details.phone_number)">
                      <!-- <img
                  class="profile-image"
                  src="https://www.clarity-enhanced.net/wp-content/uploads/2020/06/robocop.jpg"
                  alt=""
                /> -->
                      <div class="profile-image">
                        {{details.whatsapp_name |firstlater}}
                      </div>
                      <div class="text">
                        <h6>{{details.whatsapp_name}}</h6>
                        <p class="text-muted">
                          {{details.country_code}}{{details.phone_number}}
                        </p>
                      </div>
                      <span class="time text-muted small">{{details.payload.timestamp}}</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            <dir-pagination-controls max-size="10" on-page-change="historyPageChanged(newPageNumber)"
              boundary-links="true">
            </dir-pagination-controls>
          </div>
          <!-- Start Phone Chat for history tab-->
          <div class="phone-chat" ng-if="showChatModule && !isUserProfile">
            <div class="screen-phone">
              <div class="nav-phone navbar-fixed">

                <div class="icon-back">
                  <svg viewBox="0 0 57.653 64.11" width="25" height="25" xmlns="http://www.w3.org/2000/svg"
                    ng-click="hideChatModule()">

                    <path fill="#fff"
                      d="M 31.75 0 L 0 31.956 L 30.961 63.124 L 36.412 57.26 L 15.768 36.41 L 56.313 35.997 L 56.107 28.366 L 15.484 28.572 L 37.35 6.086 L 31.75 0 Z" />
                  </svg>


                </div>
                <div>

                  <span class="username">{{userChatData.whatsapp_name}}</span><br />
                  <span class="tel-number">({{userChatData.country_code}}{{userChatData.phone_number}})</span>

                  <div class="profile-image-chat" ng-click="userProfileIcon()">
                    {{userChatData.whatsapp_name |firstlater}}
                  </div>
                </div>

              </div>

              <div class="chat">
                <div ng-repeat="chat in userChatData.payload track by $index">
                  <!-- <div > {{chat.timestamp | date : format : timezone}}</div> -->
                  <div style="width: 100%; float:right;">
                    <div class="message-1" ng-if="chat.sender=='user'">
                      {{chat.content.text}}
                      <span>{{chat.timestamp | date :'h:mma'}}</span>
                    </div>
                  </div>

                  <div class="message-2 white-space-pre-line" ng-if="chat.sender=='bot'">
                    {{chat.content.text}}
                    <span>{{chat.timestamp | date : 'h:mma'}}</span>
                  </div>
                </div>

              </div>
              <div ng-if="messageBox">
                <div class="input">
                  <input type="text" placeholder="Write message" />
                </div>
                <div class="btn-send">
                  <svg viewBox="0 0 74.433 60.908" width="25" height="25" xmlns="http://www.w3.org/2000/svg">
                    <path fill="#fff"
                      d="M 0 0 L 74.22 26.562 L 0.246 60.712 L 7.608 34.535 L 27.831 28.259 L 6.91 25.469 L 0 0 Z" />
                  </svg>
                </div>
              </div>
            </div>
          </div>
          <!--End Phone Chat  for history tab-->
        </div>

      </div>
    </div>
  </div>
  <!--/History Tab-->

  <!--Contact Tab-->
  <div class="container dropdown mca-page" ng-if="showcontactDetail">
    <h3><b>CONTACT</b></h3>

    <div class="container table-responsive py-5">
      <table class="table table-bordered table-hover">
        <thead class="thead-dark">
          <tr>
            <th scope="col">Sr. No.</th>
            <th scope="col">Name</th>
            <th scope="col">Mobile Number</th>
            <th scope="col">Status</th>
            <th scope="col">Last Active</th>
            <th scope="col">Created At</th>
          </tr>
        </thead>
        <tbody>
          <!-- <tr ng-repeat="contact in contactDetailData track by $index"> -->
          <tr dir-paginate="contact in contactDetailData | itemsPerPage:itemsPerPage" total-items="totalCount"
            current-page="pagination.current" track by "$index">
            <td>{{$index+serial}}</td>
            <td>{{contact.whatsapp_name}}</td>
            <td>{{contact.country_code}}{{contact.phone_number}}</td>
            <td>{{contact.user_type}}</td>
            <td>{{contact.updated_at | date : 'medium'}}</td>
            <td>{{contact.created_at | date : 'medium'}}</td>
          </tr>
        </tbody>
      </table>
      <dir-pagination-controls max-size="10" on-page-change="pageChanged(newPageNumber)" boundary-links="true">
      </dir-pagination-controls>
      <!-- <div data-pagination="" data-num-pages="numOfPages()" data-current-page="curPage" data-max-size="maxSize"
        data-boundary-links="true"> -->
    </div>
  </div>
  <!--/Contact Tab-->

  <!--Template Tab-->
  <div class="container dropdown mca-page" ng-if="showtemplateDetail">

    <div class="add-button">
      <button type="button" class="btn btn-info">Add+</button>
    </div>

    <h3 style="padding: 5px; margin-bottom: 20px;"><b>TEMPLATE</b></h3>

    <div class="search-box">
      <div class="input-wrapper">
        <i class="fa fa-search" aria-hidden="true" style="margin-left: 10px"></i>

        <input placeholder="Search here" ng-change="templateDetail(templateSearch)" ng-model="templateSearch"
          type="text" />

      </div>
    </div>

    <div class="container table-responsive py-5">
      <table class="table table-bordered table-hover">
        <thead class="thead-dark">
          <tr>
            <th scope="col">Sr. No.</th>
            <th scope="col">Template ID</th>
            <th scope="col">Name</th>
            <th scope="col">Template Message</th>
            <th scope="col">Status</th>
            <th scope="col">Created At</th>
            <th scope="col">Bot Name</th>
          </tr>
        </thead>
        <tbody>
          <tr dir-paginate="template in templateDetailData| itemsPerPage:itemsPerPage" total-items="totalCount"
            current-page="pagination.current" track by "$index">
            <td>{{$index+serial}}</td>
            <td>{{template.template_code}}</td>
            <td>{{template.template_name}}</td>
            <td>{{template.Template_message}}</td>
            <td>{{template.status}}</td>
            <td>{{template.date}}</td>
            <td>{{template.bot_name}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <!--/Template-->

  <!--Filter Tab-->
  <div class="container dropdown mca-page" ng-if="showfilterDetail">
    <h3><b>FILTER</b></h3>



    <div class="page-inner">
      <div class="top-select-option-mca">
        <div class="form-group">
          <!--For sector dropdown-->

          <input class="form-control" type="date" id="date" name="date">

        </div>

        <div class="second dropdown">
          <div class="row">
            <div class="col-xs-4">
              <div class="form-group">
                <!--category dropdown-->
                <select class="form-control" ng-change="" name="category" id="category" ng-model="category_code">
                  <option value="" disabled> Select Attribute</option>
                  <option ng-repeat="category in categoryData track by $index" value="{{category.category_code}}"
                    style="text-transform: capitalize">
                    {{}}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-xs-4">
              <div class="form-group">
                <!--category dropdown-->
                <select class="form-control" ng-change="" name="category" id="category" ng-model="category_code">
                  <option value="" disabled> is</option>
                  <option ng-repeat="category in categoryData track by $index" value="{{category.category_code}}"
                    style="text-transform: capitalize">
                    {{}}
                  </option>
                </select>
              </div>
            </div>

            <div class="col-xs-4">
              <div class="form-group">
                <!--category dropdown-->
                <select class="form-control" ng-change="" name="category" id="category" ng-model="category_code">
                  <option value="" disabled>Attribute Value</option>
                  <option ng-repeat="category in categoryData track by $index" value="{{category.category_code}}"
                    style="text-transform: capitalize">
                    {{}}
                  </option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
  <!--/Filter Tab-->
</div>